nohup: ignoring input
/scratch/ashvin/mx-scaling-tests/.venv/lib/python3.12/site-packages/transformers/utils/hub.py:111: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/scratch/ashvin/mx-scaling-tests/.venv/lib/python3.12/site-packages/ignite/handlers/checkpoint.py:16: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import ZeroRedundancyOptimizer
2025-10-06 13:40:13,880 - INFO - Tier B selected. Will replace modules matching: ['q_proj', 'k_proj', 'v_proj', 'o_proj', 'c_attn', 'c_proj', 'query', 'key', 'value', 'dense', 'Wqkv', 'out_proj', 'gate_proj', 'up_proj', 'down_proj', 'fc1', 'fc2', 'w1', 'w2', 'w3', 'dense_h_to_4h', 'dense_4h_to_h', 'mlp.c_fc', 'mlp.c_proj']
2025-10-06 13:40:13,880 - INFO - MX stage skipped by flag; tier selection will apply to NV-FP8 only.
2025-10-06 13:40:14,292 - INFO - MX Configuration: {'w_elem_format': 'fp8_e4m3', 'a_elem_format': 'fp8_e4m3', 'scale_bits': 8, 'block_size': 32, 'custom_cuda': True, 'quantize_backprop': False, 'round': 'even', 'w_elem_format_bp': 'fp8_e4m3', 'a_elem_format_bp': 'fp8_e4m3', 'a_elem_format_bp_os': 'fp8_e4m3', 'a_elem_format_bp_ex': 'fp8_e4m3', 'round_m': 'even', 'round_output': 'even', 'round_grad_weight': 'even', 'round_grad_input': 'even', 'round_weight': 'even', 'round_mx_output': 'even', 'round_mx_input_grad_input': 'even', 'round_mx_weight_grad_input': 'even', 'round_mx_grad_output_grad_input': 'even', 'round_mx_input_grad_weight': 'even', 'round_mx_grad_output_grad_weight': 'even'}
2025-10-06 13:40:14,292 - INFO - Loading evaluation data...
2025-10-06 13:40:14,292 - INFO - Loading 200 samples from The Pile (train split)...
'(MaxRetryError('HTTPSConnectionPool(host=\'cas-bridge.xethub.hf.co\', port=443): Max retries exceeded with url: /xet-bridge-us/64ef8ede6c34f89ab1791292/692dc8ac96e9f0980e30d49a6ca669c9e47ad961f88c0c784569f56921dea5e1?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=cas%2F20251006%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20251006T203958Z&X-Amz-Expires=3600&X-Amz-Signature=f4cff641e34dc59e9395fd07fb973fd4cf0cb88677fb0af38c12d10f92846000&X-Amz-SignedHeaders=host&X-Xet-Cas-Uid=68116ba488993d6dc8f6da4a&response-content-disposition=inline%3B+filename*%3DUTF-8%27%2700.jsonl.zst%3B+filename%3D%2200.jsonl.zst%22%3B&x-id=GetObject&Expires=1759786798&Policy=eyJTdGF0ZW1lbnQiOlt7IkNvbmRpdGlvbiI6eyJEYXRlTGVzc1RoYW4iOnsiQVdTOkVwb2NoVGltZSI6MTc1OTc4Njc5OH19LCJSZXNvdXJjZSI6Imh0dHBzOi8vY2FzLWJyaWRnZS54ZXRodWIuaGYuY28veGV0LWJyaWRnZS11cy82NGVmOGVkZTZjMzRmODlhYjE3OTEyOTIvNjkyZGM4YWM5NmU5ZjA5ODBlMzBkNDlhNmNhNjY5YzllNDdhZDk2MWY4OGMwYzc4NDU2OWY1NjkyMWRlYTVlMSoifV19&Signature=cTlpzQrtLJRnTykhjCtsbrcy1-GlzRR8CTpAkngeNAa9BnVImJ8vk83fpUK3riUYtJ01ltX~iIT3EgNFivHQKEoO-MSJ9IrkUE1zDI8nJUBozDIsf62swsM4KQJDCPRXPQgGNnPV1vkeBqFTbXzvw4Jcvir8p8lQ7RtrQSfsmw4j3vpOimzqKAitSTDdKwAtq9qw8NxL7iuBEjmV2svFhCfSwr6xjAKrqr39FHAg2sE9tKjVX9TDimFf7R10Ah8bDRdPvtTdd2WUj5~-iCT72CJca-IIw5chyZWm-UDPpUnCzqKAKw6xgc6cB8ZL5Jeh5ojVr2DExMJpkcihPGW2QQ__&Key-Pair-Id=K2L8F4GPSG1IFC (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x740b1613c290>: Failed to resolve \'cas-bridge.xethub.hf.co\' ([Errno -5] No address associated with hostname)"))'), '(Request ID: 3a87e1b8-effb-4d7b-b2eb-4048bb55e5d9)')' thrown while requesting GET https://huggingface.co/datasets/monology/pile-uncopyrighted/resolve/3be90335b66f24456a5d6659d9c8d208c0357119/train/00.jsonl.zst
Retrying in 1s [Retry 1/5].
2025-10-06 13:40:18,956 - INFO - Loaded 200 samples from The Pile
2025-10-06 13:40:18,956 - INFO - ================================================================================
2025-10-06 13:40:18,956 - INFO - SELECTIVE MX GEMM REPLACEMENT BENCHMARK
2025-10-06 13:40:18,956 - INFO - ================================================================================
2025-10-06 13:40:18,957 - INFO - 
================================================================================
2025-10-06 13:40:18,957 - INFO - Evaluating: deepseek-llm-67b-base
2025-10-06 13:40:18,957 - INFO - ================================================================================
2025-10-06 13:40:18,957 - INFO - 
--- Baseline (FP32/BF16) ---
2025-10-06 13:40:20,870 - INFO - Baseline         Using GPUs: [1, 2, 3, 4, 5, 6, 7] with 1 worker(s)/device
Fetching 14 files:   0%|          | 0/14 [00:00<?, ?it/s]